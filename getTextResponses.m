function [response,string] = getTextResponses(window,msg,x,y,textColor,bgColor)% string = GetEchoString(window,msg,x,y,textColor,bgColor)% % Get a string typed at the keyboard. Entry is terminated by% <return> or <enter>.%% Typed characters are displayed in the window. The delete% character is handled correctly. Useful for i/o in a Screen window.%% See also: GetNumber, GetString, GetEchoNumber%% 2/4/97  dhb  Wrote GetEchoNumber.% 2/5/97  dhb  Accept <enter> as well as <cr>.%         dhb  Allow string return as well.% 3/3/97  dhb  Updated for new DrawText.  % 3/15/97 dgp  Created GetEchoString based on dhb's GetEchoNumber.% 3/20/97 dhb  Fixed bug in erase code, it wasn't updated for new%              initialization.% 3/31/97 dhb  More fixes for same bug.% 2/28/98 dgp  Use GetChar instead of obsolete GetKey. Use SWITCH and LENGTH.% 3/27/98 dhb  Put an abs around char in switch.% 6/27/16 srk  Made significant edits to make it work on PTB 3, Mac OS%               10.11, MATLAB 2015b%Turn on listenCharListenChar(2);% Write the message and a spaceScreen(window,'TextSize', 32);msg=[msg '\n \n \n'];% Screen(window,'DrawText',[msg '  '],x/2,y,textColor);DrawFormattedText(window,msg,x/2,y*.5,textColor,75);Screen('Flip', window);% Determine position for first characteroffset=length(msg)+3;string=[msg ''];y0=0;x0=0;% yPositionIsBaseline=0;while 1	% Loop until <return> or <enter>	char= GetChar(0,1);    switch(abs(char))		case {27,10}	% <return> or <enter>			break;		case 8,			% <delete>			if length(string)>length(msg)% 				deletedChar = string(length(string));				string=string(1:length(string)-1);                Screen(window,'FillRect',bgColor);%                 Screen(window,'DrawText',string,x/2,y,textColor);                DrawFormattedText(window, string, x/2, y*.5, textColor, 75);            else                Screen(window,'FillRect',bgColor);                DrawFormattedText(window,msg,x/2,y*.5,textColor,75);			end		otherwise,			string=[string char];            Screen(window,'FillRect',bgColor); %Clearing the screen before typing new words makes sure that things deleted and moved for "wrapping text" do not remain on the screen.%             Screen(window, 'DrawText', string, x/2, y, textColor);            DrawFormattedText(window, string, x/2, y*.5, textColor, 75);    end    Screen(window,'Flip', [], 1);    endresponse=string(length(msg)+1:end);%Erase textScreen(window,'FillRect',bgColor);ListenChar(0);